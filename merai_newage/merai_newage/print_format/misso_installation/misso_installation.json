{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2025-12-10 11:39:11.407341",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Installation",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<div class=\"page-header\" style=\"margin-bottom:10px; position:relative;\">\n<table class=\"no-border-header\" style=\"width:100%; text-align:center;\">\n        <thead>\n            <tr>\n                <td style=\"width: 20%; text-align: left; border: none;\">\n                    <img src=\"/files/Meril Logo.svg\" alt=\"Test\" width=\"110px\" height=\"70px\">\n                </td>\n                <td style=\"width: 55%; text-align: center; border: none;\">\n                    <div style=\"display: flex; flex-direction: column; justify-content: center; align-items: center;\" class=\"title\">\n                                  <h3><b>Installation Commissioning<br>Report</b></h3>\n                    </div>\n                </td>\n                <td style=\"width: 25%; text-align: center; vertical-align: middle !important; border: none;\">\n                                  <p style=\"font-size: 10px\"><b>Document No. <br> PR/FMT/RS/011 Rev. No. 00</b></p>\n                </td>\n            </tr>\n        </thead>\n    </table>\n</div>\n{% set item = frappe.get_doc(\"Item\", doc.item_code) %}\n{% set assign_doc = frappe.get_doc(\"Assign Installation\", doc.assign_installation) %}\n{% set dispatch_doc = frappe.get_doc(\"Dispatch\", assign_doc.dispatch_no) %}\n\n\n<main style=\"font-size: 12px;\">\n<style>\n    /* Default: DARK borders for all tables */\n    table {\n        border-collapse: collapse !important;\n    }\n\n    table, th, td {\n        border: 1.5px solid #000 !important;\n    }\n\n    /* EXCEPTION: Header table without borders */\n    table.no-border-header,\n    table.no-border-header th,\n    table.no-border-header td {\n        border: none !important;\n    }\n    \n    .install-table {\n    border-bottom: 0 !important;\n    }\n\n    .install-table tbody tr:last-child td {\n     border-bottom: 0 !important;\n    }\n    \n    .feedback-table,\n    .feedback-table td {\n    border: none !important;\n    }\n\n    .feedback-table tr td {\n    border-bottom: 1.5px solid #000 !important;\n    height: 18px;\n    }\n\n\n    \n</style>\n\n\n\n<table width=\"100%\" border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"font-size: 12px; \">\n    <tr>\n        <th class=\"details-col\" style=\"width: 25%;\"><b>System No.:</b></th><td style=\"width: 25%;\"> {{ doc.work_order or '' }}</td>\n        <th class=\"details-col\" style=\"width: 25%;\"><b>Date:</b></th><td style=\"width: 25%;\"> {{ frappe.utils.formatdate(doc.date, \"dd-MM-yyyy\") or \"\" }}</td>\n    </tr>\n    <tr>\n        <th class=\"details-col\"><b>Name of Engineer:</b></th><td> {{ assign_doc.engineer_name or '' }}</td>\n        <th class=\"details-col\"><b>Timing:</b></th><td> {{ frappe.utils.get_time(doc.timing).strftime(\"%I:%M %p\") if doc.timing else \"\" }}</td>\n    </tr>    \n    <tr>\n        <th class=\"details-col\"><b>Hospital Name and Address</b></th><td colspan=\"3\"> {{ doc.hospital_name or '' }}<br>{{ doc.hospital_address or '' }}</td>\n    </tr>\n   \n</table>\n<br>\n<p><b>Installation commissioning steps and verification</b></p>\n<p><b>Remark:</b> All cable wirings and their respective connectors were thoroughly tightened and verification twice to ensure secure and reliable connections.</p>\n\n<br>\n\n<p><b>Installation Procedure And Verification</b></p>\n<table class=\"install-table\"  border=\"1\" width=\"100%\" style=\"font-size: 12px; text-align: center;\">\n <thead>\n    <tr>\n        <th style=\"text-align: center;\" width=\"7%\">Sr. No.</th>\n        <th style=\"text-align: center; white-space: nowrap;\">Installation Steps</th>\n        <th style=\"text-align: center;\" width=\"25%\">Remarks <br> (Verified / Not Verified)</th>\n    </tr>\n </thead>    \n    {% for i in doc.installation_step_details %}\n    <tr>\n        <td>{{ loop.index }}</td>\n        <td style=\"text-align: left; \">{{ i.installation_steps or '' }}</td>\n        <td>{% if i.remarks == \"Yes\"%}Verified{% elif i.remarks == \"No\"%}Not Verified{% else %}&nbsp{% endif %}</td>\n    </tr>\n    {% endfor %}\n</table>\n<table border=\"1\" width=\"100%\" style=\"font-size:12px; border-collapse:collapse;\">\n <thead>\n    <tr>\n        <th colspan=\"3\" >Safety Check And Precautions</th>\n    </tr> \n </thead>    \n    <tbody>\n\n    {% for row in doc.safety_check_and_precautions %}\n        {% set safety_doc = frappe.get_doc(\"Safety Check List Master\", row.safety_steps) %}\n\n        <tr>\n            <!-- Sr No -->\n            <td width=\"7%\" style=\"vertical-align:top; text-align:center;\">\n                {{ loop.index }}\n            </td>\n\n            <!-- Safety Steps + Sub Steps -->\n            <td style=\"text-align:left;\">\n                <b>{{ row.safety_steps }} :</b>\n                <ol style=\"margin-top:5px;\">\n                    {% for step in safety_doc.safety_check_details %}\n                        <li>{{ step.check_name }}</li>\n                    {% endfor %}\n                </ol>\n            </td>\n\n            <!-- Status -->\n            <td width=\"25%\" style=\"vertical-align:middle; text-align:center;\">\n                {% if row.status == \"Yes\"%}Verified{% elif row.status == \"No\"%}Not Verified{% else %}&nbsp{% endif %}\n            </td>\n        </tr>\n\n    {% endfor %}\n\n    </tbody>\n</table>\n\n\n<br>\n\n<table border=\"1\" width=\"100%\" style=\"font-size: 12px; text-align: center;\">\n <thead>\n    <tr>\n        <th colspan=\"3\" >Performance Checks</th>\n    </tr>  \n    <tr>\n        <th style=\"text-align: center;\" width=\"7%\">Sr. No.</th>\n        <th style=\"text-align: center; white-space: nowrap;\">Steps</th>\n        <th style=\"text-align: center;\" width=\"25%\">Remarks <br> (Verified / Not Verified)</th>\n    </tr>\n </thead>   \n    <tbody>\n\n    {% for row in doc.performance_check_details %}\n        {% set safety_doc = frappe.get_doc(\"Safety Check List Master\", row.performance_check) %}\n\n        <tr>\n            <!-- Sr No -->\n            <td width=\"7%\" style=\"vertical-align:top; text-align:center;\">\n                {{ loop.index }}\n            </td>\n\n            <!-- Safety Steps + Sub Steps -->\n            <td style=\"text-align:left;\">\n                <b>{{ row.performance_check }} :</b>\n                <ol style=\"margin-top:5px;\">\n                    {% for step in safety_doc.safety_check_details %}\n                        <li>{{ step.check_name }}</li>\n                    {% endfor %}\n                </ol>\n            </td>\n\n            <!-- Status -->\n            <td width=\"20%\" style=\"vertical-align:middle; text-align:center;\">\n                {% if row.status == \"Yes\"%}Verified{% elif row.status == \"No\"%}Not Verified{% else %}&nbsp{% endif %}\n            </td>\n        </tr>\n\n    {% endfor %}\n\n    </tbody> \n\n</table>\n<br>\n<p style=\"font-size:12px; font-weight:bold; margin-bottom:6px;\">\n    System Installation Feedback:\n</p>\n\n<table class=\"feedback-table\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse;\">\n    {% for i in range(6) %}\n    <tr>\n        <td></td>\n    </tr>\n    {% endfor %}\n</table>\n\n<br>\n<br>\n<p><b>Hardware/Software Replacement Tracking Log</b></p>\n<table border=\"1\" width=\"100%\" style=\"font-size: 12px; text-align: center;\">\n <thead>\n    <tr>\n        <th width=\"7%\">Sr. No.</th>\n        <th style=\"white-space: nowrap;\">Component Name</th>\n        <th>Component Part Number</th>\n        <th>Change component Part Number</th>\n        <th style=\"white-space: nowrap;\">Reason for change</th>\n    </tr>\n </thead>    \n    {% for i in doc.hardware_or_software_replacement_tracking_log %}\n    <tr>\n        <td>{{ loop.index }}</td>\n        <td style=\"text-align: left; white-space: nowrap;\">{{ i.component_name or '' }}</td>\n        <td>{{ i.component_part_no or '' }}</td>\n        <td>{{ i.change_component_part_no or '' }}</td>\n        <td>{{ i.reason_for_change or '' }}</td>\n    </tr>\n    {% endfor %}\n</table>\n\n\n<br>\n<table border=\"1\" width=\"100%\" style=\"font-size: 12px; text-align: center;\">\n\t<tr>\n\t  <th> </th>\n      <th style=\"text-align:center;\">Checked by <br> (Service Engineer)</th>\n      <th style=\"text-align:center;\">Verified by <br> (Clinical Engineer)</th>\n      <th style=\"text-align:center;\">Approved by <br> (Software Engineer)</th>\n      <th style=\"text-align:center;\">Approved by <br> (Hospital Head)</th>\n\t</tr>\n    <tr>\n    <tr>\n      <td><b>Name & Sign:</b></td>\n      <td style=\"text-align: center; white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 0 %}\n          {{ doc.bmr_record_checklist_approval_details[0].checked_by_production_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[0].checked_by_production_user_id or '' }}\n        {% endif %}\n      </td>\n      <td style=\"white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 1 %}\n          {{ doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_user_id or '' }}\n        {% endif %}\n      </td>\n      <td style=\"white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 2 %}\n          {{ doc.bmr_record_checklist_approval_details[2].reviewed_by_production_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[2].reviewed_by_production_user_id or '' }}\n        {% endif %}\n      </td>\n      <td style=\"white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 3 %}\n          {{ doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_user_id or '' }}\n        {% endif %}\n      </td>\n\t</tr>\n    <tr>\n      <td><b>Date:</b></td>\n      <td style=\"text-align: center;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 0 and doc.bmr_record_checklist_approval_details[0].checked_by_production_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[0].checked_by_production_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n      <td>\n        {% if doc.bmr_record_checklist_approval_details|length > 1 and doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n      <td>\n        {% if doc.bmr_record_checklist_approval_details|length > 2 and doc.bmr_record_checklist_approval_details[2].reviewed_by_production_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[2].reviewed_by_production_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n      <td>\n        {% if doc.bmr_record_checklist_approval_details|length > 3 and doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n\t</tr>\n</table>\n\n<br>\n<p><b>System Electrical Ratings (Misso System)</b></p>\n{{doc.description or \"\" }}\n\n<br>\n{% set disposal_items = {\n    \"MI-CN2-0002\": \"Bone Cutter 6.2mm\",\n    \"MI-CN2-0003\": \"Drape\",\n    \"MI-CN2-0004\": \"Irrigation Tube\",\n    \"MI-CN2-0001\": \"Sterile Marker Ball\"\n} %}\n\n<p><b>Sytem Packaging List</b></p>\n\n<table border=\"1\" width=\"100%\" style=\"font-size:12px; text-align:center;\">\n    <thead>\n        <tr>\n            <th style=\"text-align: center;\" width=\"7%\">Sr. No.</th>\n            <th style=\"text-align: center;\">Item List</th>\n            <th style=\"text-align: center;\">Qty.</th>\n            <th style=\"text-align: center;\" width=\"20%\">Received</th>\n        </tr>\n    </thead>\n\n    <tbody>\n\n    {% set ns = namespace(rendered=false) %}\n    {% set sr = namespace(val=1) %}\n\n    {% for i in doc.system_packaging_list %}\n\n        {% if i.item in disposal_items and i.item != \"MI-CN2-0002\" %}\n            {# skip child rows completely #}\n        {% else %}\n\n        <tr>\n            <td>{{ sr.val }}</td>\n\n            {% if i.item == \"MI-CN2-0002\" and not ns.rendered %}\n                <td style=\"text-align:left;\">\n                    <b>Disposal (From Finished Goods)</b>\n                    <ol style=\"margin:5px 0 0 15px; padding:0;\">\n                        {% for d in doc.system_packaging_list %}\n                            {% if d.item in disposal_items %}\n                                <li>\n                                    {{ disposal_items[d.item] }} \u2013 {{ d.qty | int }} nos.\n                                </li>\n                            {% endif %}\n                        {% endfor %}\n                    </ol>\n                </td>\n                <td>As per the order</td>\n                {% set ns.rendered = true %}\n\n            {% else %}\n                <td style=\"text-align:left;\">\n                    {{ frappe.db.get_value(\"Item\", i.item, \"description\") or i.item }}\n                </td>\n                <td>{{ i.qty | int or '-' }}</td>\n            {% endif %}\n\n            <td>{{ i.received or '-' }}</td>\n        </tr>\n\n        {% set sr.val = sr.val + 1 %}\n\n        {% endif %}\n    {% endfor %}\n\n    </tbody>\n</table>\n\n\n<br>\n\n<p><b>Instrument Tray (A, B, C) List</b></p>\n\n{% set trays = [\"Instrument Tray-A\", \"Instrument Tray-B\", \"Instrument Tray-C\"] %}\n\n{% for tray in trays %}\n<table border=\"1\" width=\"100%\" style=\"font-size:12px; text-align:center; margin-bottom:15px;\">\n    <thead>\n        <tr>\n            <th style=\"text-align:center;\" colspan=\"6\">{{ tray }}</th>\n        </tr>\n        <tr>\n            <th style=\"text-align:center;\" width=\"7%\">Sr. No.</th>\n            <th style=\"text-align:center;\">Tool/Assembly Name</th>\n            <th style=\"text-align:center;\">Figure</th>\n            <th style=\"text-align:center;\">Part No.</th>\n            <th style=\"text-align:center;\">Part Qty.</th>\n            <th style=\"text-align:center;\" width=\"20%\">Remark (\u2714 / \u2717)</th>\n        </tr>\n    </thead>\n    <tbody>\n        {% set ns = namespace(sr=1) %}\n\n        {% for i in doc.instrument_tray_list %}\n            {% if i.type == tray %}\n            <tr>\n                <td>{{ ns.sr }}</td>\n                <td style=\"text-align:left;\">{{ i.product_description or '' }}</td>\n                <td>{% if i.attach and i.attach.endswith(('.png','.jpg','.jpeg','.svg')) %}\n                     <img src=\"{{ i.attach }}\"style=\"width:100px; height:70px;\">\n                    {% else %}\n        -           {% endif %}\n                <td style=\"white-space:nowrap;\">{{ i.product_code or '' }}</td>\n                <td>{{ i.stdqty | int if i.stdqty else '-' }}</td>\n                <td>\n                    {% if i.status == \"Yes\" %}\n                        \u2714\n                    {% elif i.status == \"No\" %}\n                        \u2717\n                    {% else %}\n                        &nbsp;\n                    {% endif %}\n                </td>\n            </tr>\n            {% set ns.sr = ns.sr + 1 %}\n            {% endif %}\n        {% endfor %}\n    </tbody>\n</table>\n{% endfor %}\n\n\n<br>\n<br>\n<table border=\"1\" width=\"100%\" style=\"font-size: 12px; text-align: center;\">\n\t<tr>\n\t  <th> </th>\n      <th style=\"text-align:center;\">Checked by <br> (Service Engineer)</th>\n      <th style=\"text-align:center;\">Verified by <br> (Clinical Engineer)</th>\n      <th style=\"text-align:center;\">Approved by <br> (Software Engineer)</th>\n      <th style=\"text-align:center;\">Approved by <br> (Hospital Head)</th>\n\t</tr>\n    <tr>\n    <tr>\n      <td><b>Name & Sign:</b></td>\n      <td style=\"text-align: center; white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 0 %}\n          {{ doc.bmr_record_checklist_approval_details[0].checked_by_production_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[0].checked_by_production_user_id or '' }}\n        {% endif %}\n      </td>\n      <td style=\"white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 1 %}\n          {{ doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_user_id or '' }}\n        {% endif %}\n      </td>\n      <td style=\"white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 2 %}\n          {{ doc.bmr_record_checklist_approval_details[2].reviewed_by_production_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[2].reviewed_by_production_user_id or '' }}\n        {% endif %}\n      </td>\n      <td style=\"white-space:nowrap;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 3 %}\n          {{ doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_full_name or '' }}\n          - {{ doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_user_id or '' }}\n        {% endif %}\n      </td>\n\t</tr>\n    <tr>\n      <td><b>Date:</b></td>\n      <td style=\"text-align: center;\">\n        {% if doc.bmr_record_checklist_approval_details|length > 0 and doc.bmr_record_checklist_approval_details[0].checked_by_production_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[0].checked_by_production_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n      <td>\n        {% if doc.bmr_record_checklist_approval_details|length > 1 and doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[1].checked_by_quality_controlquality_assurance_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n      <td>\n        {% if doc.bmr_record_checklist_approval_details|length > 2 and doc.bmr_record_checklist_approval_details[2].reviewed_by_production_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[2].reviewed_by_production_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n      <td>\n        {% if doc.bmr_record_checklist_approval_details|length > 3 and doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_date %}\n          {{ frappe.utils.formatdate(doc.bmr_record_checklist_approval_details[3].reviewed_by_quality_controlquality_assurance_date, \"dd-MM-yyyy\") }}\n        {% endif %}\n      </td>\n\t</tr>\n</table>\n\n\n\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2025-12-25 12:39:10.040494",
 "modified_by": "Administrator",
 "module": "Merai Newage",
 "name": "MISSO-INSTALLATION",
 "owner": "Administrator",
 "page_number": "Hide",
 "pdf_generator": "wkhtmltopdf",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_for": "DocType",
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}